<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Yönlendiriliyor…</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 24px; }
    .muted { color: #666; }
  </style>
</head>
<body>
  <h3>Yönlendiriliyor…</h3>
  <p class="muted">Lütfen bekleyin.</p>

  <script>
    (function () {
      // ✅ Senin Supabase projen
      var SUPABASE_URL = "https://pdcrdlnraaiqvrpewiyz.supabase.co";

      // ✅ Uygulamanın deep link’i
      var APP_DEEPLINK = "promptio://login-callback";

      var path = window.location.pathname || "/";
      var search = window.location.search || "";
      var hash = window.location.hash || "";

      // 1) Supabase verify linki buraya gelirse:
      //    https://ofsenterprise.com/auth/v1/verify?token=...&type=signup
      // -> bunu gerçek Supabase verify endpointine taşı
      if (path.indexOf("/auth/v1/") === 0) {
        var target = SUPABASE_URL + path + search;

        // redirect_to ekle (yoksa ekle, varsa ezme)
        if (target.indexOf("redirect_to=") === -1) {
          target += (target.indexOf("?") === -1 ? "?" : "&") + "redirect_to=" + encodeURIComponent(APP_DEEPLINK);
        }

        window.location.replace(target);
        return;
      }

      // 2) Bazı akışlarda token hash ile gelebiliyor (örn: #access_token=...)
      // -> direkt app’e gönder
      if (hash && hash.indexOf("access_token=") !== -1) {
        var appUrl = APP_DEEPLINK + (hash.startsWith("#") ? ("?" + hash.substring(1)) : ("?" + hash));
        window.location.replace(appUrl);
        return;
      }

      // 3) Diğer 404’lerde ana sayfaya dön
      window.location.replace("https://ofsenterprise.com/");
    })();
  </script>
</body>
</html>
